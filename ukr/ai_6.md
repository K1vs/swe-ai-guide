### 6. Розширюваність агентів

Попри те, що сучасні агенти мають найпотрібніший набір інструментів, більш вузькоспеціалізовані інструменти зазвичай недоступні "з коробки". Для розробників це можуть бути інтеграції з ALM‑системами (Application Lifecycle Management - Jira, Azure DevOps), прототипуванням дизайнів (Figma), схемами API‑контрактів чи роботою з базами даних. Оскільки ці інтеграції часто складні, а постачальники пропонують різні рівні можливостей, включати все це безпосередньо в агент недоцільно. Тому ще у перших поколіннях популярних агентів було передбачено механізми розширення, що дозволило підключати окремі модулі з додатковою функціональністю.

Характерний і дуже корисний приклад з практики - розширення для VS Code з Copilot для роботи з базою даних PostgreSQL. Воно дозволяє агентові виконувати запити до PostgreSQL, оперативно створювати початкові чи тестові дані, перевіряти поточний стан даних і робити на основі цього корисні висновки. Перевага підходу - розширення "ідеально підігнане" під конкретного клієнта (редактор/агент). Недолік - множення зусиль: підтримувати окремі розширення під кожного агента і для кожного інструменту дуже витратно.

Це класична точка для "мосту" - спільного протоколу, який розуміють і агенти, і інструменти. У 2024 році компанія Anthropic запропонувала Model Context Protocol (MCP) - стандарт обміну командами, даними та контекстом між агентом і зовнішніми сервісами. MCP задає ролі й транспорт, щоб зробити інтеграції повторно використовуваними й переносними між агентами.

### Ролі в MCP: агент як клієнт, інструмент як сервер

- Агент виступає клієнтом MCP. Він ініціює з’єднання, оглядає можливості сервера (discovery), запитує ресурси, викликає інструменти, підписується на події та передає на сервер релевантний контекст сесії.
- Інструмент/сервіс реалізує MCP‑сервер. Він описує доступні ресурси (documents, datasets, endpoints), команди (tools/actions), можливі параметри, права доступу і формати відповідей. Сервер також може пропонувати стримінгові події або нотифікації для реактивних сценаріїв.

Ключова ідея: агент не вшиває підтримку конкретної системи. Натомість він уніфіковано "викликає" MCP‑сервери. Завдяки цьому один і той самий MCP‑сервер (наприклад, для Jira) може працювати з різними агентами, а агент, який уміє MCP, може одразу користуватися будь‑яким сумісним сервером.

### Транспорти підключення: pipes та HTTP

MCP підтримує кілька способів з’єднання:

- Pipes/stdio: локальне підключення через стандартні потоки або іменовані пайпи (на Windows). Мінімальна затримка, простіше розгорнути локально поруч із агентом/IDE.
- HTTP(S): мережеве підключення до віддаленого MCP‑сервера. Підходить для хмарних сервісів, командної роботи і масштабування. Дає змогу додати TLS, проксі, контроль доступу на мережевому рівні.

Окремо набирає обертів "remote MCP" - розгортання серверів поза локальним середовищем розробника (у хмарі чи внутрішній інфраструктурі), до яких агенти підключаються через HTTP(S). Це спрощує централізоване керування доступами, оновленнями та спільним використанням інтеграцій усією командою.

### Корисні приклади MCP‑серверів

- Atlassian Remote MCP (Jira, Confluence): практична цінність - швидке збагачення контексту задач. Якщо опис розкиданий по кількох тікетах у Jira і статтях у Confluence, агент сам пройде за посиланнями, збере релевантні фрагменти, побудує стислий контекст і використає його для планування чи реалізації. Після завершення роботи агент здатний оновити тікет: виставити статус, заповнити поля (наприклад, affected area), додати посилання на MR/PR - те, що розробники часто відкладають.
- GitHub MCP: корисно при мікросервісній архітектурі з окремими репозиторіями. Агент може автоматично підтягнути очікуваний контракт сервісу (OpenAPI/Protobuf/GraphQL schema), звірити версії, знайти breaking changes, створити PR з оновленнями клієнта або тестами сумісності.
- Figma MCP: для FE‑розробників (Frontend) - сильний прискорювач. Агент витягує специфікації з макетів (розміри, стилі, токени), генерує каркас компонентів/сторінок, формує checklist для верстки та порівнює фактичну реалізацію з макетом.

Перевага такого підходу для вендорів на кшталт Atlassian - не потрібно робити плагін під кожного конкретного агента або IDE. Достатньо підтримувати один MCP‑сервер. У свою чергу, автори агентів не зобов’язані інтегруватися окремо з кожною ALM - їм потрібен лише стабільний MCP‑клієнт.

### Безпека MCP: ризики та пом’якшення

Стандартизація інтеграцій підвищує ризики неправильного або надмірного доступу. Ключові практики безпеки:

- Мінімально необхідні привілеї: виділяйте окремі технічні обліковки за принципом найменших привілеїв (least privilege); розмежовуйте права для читання/запису; вимикайте небезпечні дії за замовчуванням.
- Чіткі дозволи на дії: агент повинен запитувати явне підтвердження користувача для деструктивних операцій (переведення тікета, масові оновлення, запис у БД). Використовуйте список дозволених (allowlist) інструментів і доменів.
- Аутентифікація й аудит: OAuth/OIDC, короткоживучі токени, ротація ключів, прив’язка до конкретних робочих просторів. Журнали доступів, трасування викликів і збереження артефактів для розслідувань.
- Захист від витоку даних: фільтрування PII (Personally Identifiable Information - персональні дані)/секретів у відповідях серверів, політики redaction, шифрування в транзиті (TLS) і, за потреби, у стані спокою. Обмеження обсягу контенту, що повертається у контекст LLM.
- Протидія prompt‑injection: коли агент "клікає" сторінки Jira/Confluence чи README у репозиторіях, обов'язково нормалізуйте вміст, ізолюйте невідомий HTML/скрипти. Застосовуйте політики контентної безпеки і евристики для виявлення інструкцій, що змінюють поведінку агента.
- Мережеві контролі: сегментація, фільтрація вихідного трафіку (egress) для HTTP‑транспорту, ліміти швидкості, захист від SSRF (Server-Side Request Forgery - підробка серверних запитів), обмеження зовнішніх доменів.
- Пісочниця для write‑операцій: для репозиторіїв - робота в форках/гілках із захистом, для БД - окремі тестові схеми або read‑replica для читання, для ALM - sandbox‑проекти.

### Практика впровадження

#### Просте підключення готового MCP‑сервера до готового агента

- Це реально просто: зазвичай достатньо кількох рядків у конфігурації, які сам агент підкаже або згенерує. У нових версіях VS Code підключення багатьох серверів доступне прямо з маркетплейсу з автонаповненням конфігурації.
- Типовий сценарій: вибираєте сервер (наприклад, GitHub/Brave/Figma), підтверджуєте команду запуску й додаєте потрібні змінні середовища (токен/ключ). Агент показує статус (running/failed) і готові інструменти.
- У Cursor додавання серверів відбувається через налаштування; у VS Code - через команду "MCP: Add Server" або картку розширення. Час підключення - 1–2 хвилини без глибоких технічних деталей.

#### Практики розробки MCP‑серверів і клієнтів в агентах

- Сервери: чіткий контракт (capabilities/tools/resources), стабільні схеми відповідей, версіонування. Пагінація/ліміти для керування контекстом, прозора модель помилок, ідемпотентність для write‑операцій. Аутентифікація (OAuth/OIDC), спостережуваність (логи/трасування), захист від prompt‑injection і фільтрація секретів/PII (персональних даних).
- Клієнти (агенти): discovery‑потік і feature‑gating, валідація параметрів до виклику, таймаути/ретраї. Бюджетування контексту, явні підтвердження для деструктивних дій, allowlist інструментів/доменів. Деградація при недоступності, телеметрія використання.
- Важливо: у багатьох сучасних продуктах варто ще на етапі дизайну закладати й пропонувати клієнту реалізацію MCP‑сервера. Це дозволяє користуватися сервісом не лише безпосередньо людьми, а й LLM‑агентам - без окремих плагінів під кожен інструмент/IDE.

### Підсумок

MCP знімає бар'єр "один інструмент - одне розширення - один агент" і переводить інтеграції на спільну шину. Агент як клієнт уніфіковано відкриває інструменти, а інструменти як сервери публікують можливості, що можна використовувати повторно. 

Підключення через pipes підходить для локального сценарію з мінімальною затримкою, а HTTP(S) - для віддалених і командних сценаріїв. Remote MCP робить інтеграції спільним ресурсом команди. 

Практичні виграші - швидке складання контексту задач (Jira/Confluence), автоматичний доступ до контрактів (GitHub) і прискорення верстки (Figma). 

Усе це потребує дисципліни безпеки: мінімальні права, підтвердження небезпечних дій, аудит, захист від витоків і prompt‑injection. Дотримуючись цих принципів, MCP дає збалансований спосіб масштабувати можливості агентів без вибуху витрат на інтеграції.



### Джерела

- Офіційна специфікація MCP: https://modelcontextprotocol.io
- GitHub організація: https://github.com/modelcontextprotocol
- TypeScript SDK: https://www.npmjs.com/package/@modelcontextprotocol/sdk
- Python SDK: https://pypi.org/project/mcp/
- Приклади серверів і фреймворків: https://github.com/modelcontextprotocol/servers
- MCP у агентах (OpenAI Agents): https://openai.github.io/openai-agents-js/guides/mcp
- Побудова MCP‑сервера (Cloudflare Workers): https://developers.cloudflare.com/agents/guides/build-mcp-server/
- Використання MCP з Claude Desktop: https://docs.anthropic.com/claude/docs/mcp
- Агенти на Azure з MCP: https://learn.microsoft.com/en-us/azure/developer/ai/intro-agents-mcp